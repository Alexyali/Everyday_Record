# 拥塞控制算法评估和思考

算法在随机丢包下应该如何表现？依然保持高吞吐量吗，高随机丢包率下呢？

只要链路延迟还是最低，那么保持高吞吐量也没有关系，因为随机丢包该丢还是会丢，降低发送速率不会有用

传统TCP拥塞控制算法抗随机丢包性能都很差，1%的随机丢包率就可以大幅下降吞吐量。但是随机丢包其实不是拥塞丢包，而且链路延迟没有增加。那么基于延迟的算法是否抗丢包性能都很强。

抗随机丢包：PCC, BBR, Copa

最终目标是高吞吐量和低延迟。从理论上，高吞吐量和低延迟的最优操作点只有一个，飞行数据小于BDP时，吞吐量小，高于BDP时，延迟变高。

## 性能实验

- 在数据中心之间的环境下测试算法的吞吐量，网络稳定，基本无丢包；
- 卫星链路下测试**长RTT的容忍性**，高RTT和0.74%随机丢包率。吞吐量随瓶颈节点缓冲大小的变化曲线，对比PCC和Hybla, cubic, lllinois。同样测试吞吐量，更小缓冲可以达到更高吞吐量效果更好。在Vivace的论文中比较了PCC Allegro, BBR, CUBIC
- **对随机丢包的抗性**：使用Emulab仿真100Mbps, 30ms RTT和丢包率可变的网络。CUIBC在1%随机丢包下速率降低到3%带宽。而PCC仍保持在95%左右。此处缺少延迟的对比？

- 短RTT流和长RTT流共享一个瓶颈节点的公平性问题，传统的TCP算法下，短RTT流能获取更多带宽。在Emulab下设置一路短RTT流和一路长RTT流共享一个瓶颈节点，长RTT流先运行5s。
- 瓶颈链路的缓冲小于BDP时，测试带宽利用率。使用Emulab仿真30ms RTT, 100Mbps和可变网络缓冲1.5KB到1BDP。比较各个协议在100s内的平均吞吐量。PCC只需要6MSS就可以达到90%容量，而TCP只能达到30%。在Vivace论文中还测试了缓冲大小和丢包率的关系。还比较了延迟膨胀率和缓冲大小的关系。
- **快速变化的网络**下测试，在Emulab下测试带宽、丢包率和RTT每5秒变化一次的路径，每个参数符合正态分布，带宽范围10-100Mbps, 延迟10-100ms, 丢包率0-1%。最后计算的是平均吞吐量？和最优值对比。在VIvace的论文中，对每个协议，重复100次实验，每次500秒。并计算平均吞吐量和丢包率的累计分布曲线。
- LET网络测试平均吞吐量和自限延迟。使用mahmahi复现LTE路径，并比较了Vivace, Allegro, BBR和CUBIC, Vegas和Sprout。

## 公平性收敛性实验

- 公平性：在同一个瓶颈链接设置四个发送-接收端，四路流。每路流持续2000s，依次间隔500s进入网络然后离开。记录所有流的吞吐量变化。每次实验四路流都采用同一种算法。结果是PCC比CUIBIC更加公平。
- 收敛速度：定义收敛时间为从[t,t+5]的吞吐量都在最优公平速率的25%内的最小t。稳定性是超过收敛时间60s后的吞吐量的标准差。设置两路流共享一个100Mbps和30ms RTT的瓶颈链路。流A先进入网络，20s后流B才进入网络，记录流B的收敛时间和稳定性。PCC可以改变参数以在稳定性和收敛时间中取得平衡，更快的收敛会更不稳定。

## TCP友好性-可部署性

- 在Eumlab上初始化两路竞争流，一个参考流运行CUBIC，一个竞争流运行CUBIC或者PCC，改变带宽和RTT做多组实验，瓶颈节点的缓冲始终等于BDP。计算参考流分别和CUBIC和PCC竞争的吞吐量的比率。如果比率小于1，则说明PCC更友好。
- 还可以将PCC和多流并行TCP流的总吞吐量进行比较，判断其TCP友好性

## 思考

- 如果设计在基于丢包和基于延迟的模式下切换算法，需要评估什么？和Cubic一起运行的吞吐量吗。Copa的切换算法只是为了应对和cubic竞争流量的问题
- 视频流应用如DASH的场景测试：如何测试，部署不同协议算法然后检测DASH的缓冲时间比率吗？