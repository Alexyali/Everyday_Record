# QARC: 基于深度强化学习的用于实时视频流的视频质量感知速率控制

## 摘要

- 因为在不同的网络状况下吞吐量的波动，如何自适应选择合适的比特率成为一个热门课题。为了解决这个问题，大部分提出的速率控制方法设计为提供高的视频比特率而不是视频质量。我们注意到在发送速率和视频质量之间存在平衡
- 本文我们提出了QARC速率控制算法，目的是获得更高的感知视频质量，并降低发送速率和传输延迟。QARC使用深度强化学习算法训练神经网络，根据先前的网络状态和视频帧选择未来的比特率。为了克服状态爆炸问题，我们设计了一个神经网络预测未来的感知视频质量。

## 介绍

- 由于各种网络条件下复杂的环境和随机性，以高视频比特率和低延迟传输视频流已经成为实时视频流场景中的基本挑战。许多速率控制方法被提出，比如基于丢包的方法（TFRC, RAP）和基于延迟的方法（Vegas, LEDBAT）和基于延迟的方法（GCC，Rebera）。这些方法的共同策略是在网络状况的限制下尽可能提高比特率。但是由于视频质量和比特率的不平衡性，这个策略会浪费带宽资源。*ps. 可以考虑设计结合感知质量和带宽的效用函数？* 
- 在本篇论文中，我们提出了QARC，基于深度学习的速率控制算法，目的是获得高视频质量和低延迟。因为固定的规则很难有效解决复杂的网络状况和视频内容，因此我们提出了基于DRL的方法选择未来的视频质量。QARC使用DRL方法训练神经网络基于过去时间的网络状况和历史视频帧为未来视频帧选择比特率。如果直接导入原始图像作为状态的输入，状态空间会造成状态爆炸。为了解决这个问题我们分解为了两个模型：一个模型是视频质量预测网络，可以通过先前视频帧预测未来视频质量；另一个是视频质量强化学习，VQRL使用A3C模型训练。VQRL的输入是过去时间观察到的网络状况和VQPN观察到的未来视频质量，输出是下一个视频的比特率，有高质量和低延迟。
- 我们设计了不同的训练方法。为了训练VQPN,我们构建了包含不同类型视频的数据集。为了训练VQRL，我们提出了一个离线加速网络仿真器来模拟真实的网络环境。
- 本文的贡献：
  - 我们提出了一个新颖的角度评估QoE，目标是优化视频质量而不是视频比特率
  - 我们是首先建立DRL模型来为未来视频帧选择发送比特率 ，该模型根据感知的视频质量和实时视频流的网络状态
  - 因为输入状态的复杂性，我们将神经网络划分为两个部分：第一部分的神经网络根据过去的视频帧预测未来的视频质量；第二部分的RL模型根据第一个模型的输出决策合适的比特率。使用第一个模型的输出而不是原始视频帧可以有效降低RL模型的状态空间

## 动机

- 我们建立了一个测试平台用于评价在给定编码速率下的选择视频的视频质量。在我们的实验中，选择三种视频，分别是live-cast, live concert
- 问题：为视频选择合适的比特率，不是应该根据网络状况来吗。它的目的是有时候选择更高的比特率为视频质量带来的提升不明显，因此设置一个视频质量和比特率权衡的QoE，平衡发送速率。

